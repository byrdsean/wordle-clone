let library=[];const lines=document.querySelectorAll(".line"),keyMap=new Map;let currentLineIndex=0,currentWord,currentWordMetrics,genericPopupTimeout,isGameOver=!1,areInstructionsShown=!0;const styleNames={SHOW_POPUP:"show",POPULATED_LETTER:"populated",SHAKE_LETTER:"shake",SHAKE_LINE:"shake-line",NOTFOUND_LETTER:"not-found",INCORRECT_LOCATION_LETTER:"incorrect-location",CORRECT_LOCATION:"correct-location",KEY_PRESS:"press",DEFAULT_KEY_STYLES:["key","enter","backspace"]},addKeyEvents=()=>{document.querySelectorAll(".key").forEach(e=>{const r=e.getAttribute("value");r&&(keyMap.set(r,e),e.addEventListener("mousedown",()=>{keypress(r),showPressedKey(r)}),e.addEventListener("mouseup",()=>{removePressedKey(r)}))}),window.addEventListener("keydown",e=>{keypress(e.key),showPressedKey(e.key)}),window.addEventListener("keyup",e=>{removePressedKey(e.key)})},addInstructionEvents=()=>{const r=document.querySelector("#instructions");[document.querySelector("#close-instructions"),document.querySelector("#instruction-bg")].forEach(e=>{e.addEventListener("click",()=>{r.classList.add("hide"),areInstructionsShown=!1})}),document.querySelector("#show-instructions").addEventListener("click",()=>{r.classList.remove("hide"),areInstructionsShown=!0}),r.classList.remove("hide"),areInstructionsShown=!0},addPlayAgainEvents=()=>{document.querySelector("#playAgainYes").addEventListener("click",e=>{resetGame()}),document.querySelector("#playAgainNo").addEventListener("click",e=>{document.querySelector("#playAgain").classList.remove(styleNames.SHOW_POPUP)})},showPressedKey=e=>{e=keyMap.get(e.toUpperCase());e&&e.classList.add(styleNames.KEY_PRESS)},removePressedKey=e=>{e=keyMap.get(e.toUpperCase());e&&e.classList.remove(styleNames.KEY_PRESS)},getCurrentWord=()=>{var e=Math.floor(Math.random()*library.length);return library[e].toUpperCase()},setWordMetrics=e=>{const s=new Map;return e&&e.split("").forEach((e,r)=>{var t=s.get(e)||[];s.set(e,[...t,r])}),s},keypress=e=>{var r,t,s;if(!(areInstructionsShown||isGameOver||!e||lines.length<=currentLineIndex))return"ENTER"===e.toUpperCase()?validateValue():"BACKSPACE"===e.toUpperCase()?removeLetter():void(1!==e.length||(e=e.toUpperCase(),r="A".charCodeAt(0),t="Z".charCodeAt(0),(s=e.charCodeAt(0))<r)||t<s||addLetter(e))},getCurrentLineLetters=()=>Array.from(lines[currentLineIndex].querySelectorAll(".letter")),removeLetter=()=>{var e=getCurrentLineLetters().reverse().find(e=>0!==e.innerHTML?.length);e&&(e.innerHTML="",e.classList.remove(styleNames.POPULATED_LETTER),shakeLetter(e))},addLetter=e=>{var r=getCurrentLineLetters().find(e=>0===e.innerHTML?.length);r&&(r.innerHTML=e,r.classList.add(styleNames.POPULATED_LETTER),shakeLetter(r))},shakeLetter=e=>{e.classList.add(styleNames.SHAKE_LETTER),setTimeout(()=>{e.classList.remove(styleNames.SHAKE_LETTER)},250)},shakeCurrentLine=e=>{e.classList.add(styleNames.SHAKE_LINE),setTimeout(()=>{e.classList.remove(styleNames.SHAKE_LINE)},500)},validateValue=()=>{var e,r=getCurrentLineLetters();r.find(e=>0===e.innerHTML?.length)?(showGenericPopup("Not enough letters"),shakeCurrentLine(lines[currentLineIndex])):(e=r.map(e=>e.innerHTML).join("").toLowerCase(),library.includes(e)?Array.from(lines).filter((e,r)=>r!==currentLineIndex).map(e=>Array.from(e.querySelectorAll(".letter")).map(e=>e.innerHTML).join("").toLowerCase()).filter(e=>0<e.length).includes(e)?(showGenericPopup("Word already added."),shakeCurrentLine(lines[currentLineIndex])):(r.forEach((e,r)=>{var t=e.innerHTML,s=currentWordMetrics.get(t)||[],t=keyMap.get(t);0===s.length?(e.classList.add(styleNames.NOTFOUND_LETTER),setKeyStyle(t,styleNames.NOTFOUND_LETTER)):(s=void 0===s.find(e=>e===r)?styleNames.INCORRECT_LOCATION_LETTER:styleNames.CORRECT_LOCATION,e.classList.add(s),setKeyStyle(t,s))}),currentLineIndex++,checkIfEndGame()):(showGenericPopup("Not in word list."),shakeCurrentLine(lines[currentLineIndex])))},setKeyStyle=(e,r)=>{1===e.classList.length&&e.classList.add(r)},showGenericPopup=e=>{const r=document.querySelector("#genericPopup");r&&(r.classList.add(styleNames.SHOW_POPUP),r.querySelector("#genericMessage").innerHTML=e),genericPopupTimeout||clearInterval(genericPopupTimeout),genericPopupTimeout=setTimeout(()=>{r.classList.remove(styleNames.SHOW_POPUP)},1e3)},checkIfEndGame=()=>{var e=lines[currentLineIndex-1];Array.from(e.querySelectorAll(".letter")).map(e=>e.innerHTML).join("")===currentWord.toUpperCase()?(document.querySelector("#wonPopup").classList.add(styleNames.SHOW_POPUP),isGameOver=!0):lines.length<=currentLineIndex&&((e=document.querySelector("#failurePopup"))&&(showPuzzleWord(e.querySelector("#puzzleWord")),e.classList.add(styleNames.SHOW_POPUP)),isGameOver=!0),isGameOver&&document.querySelector("#playAgain").classList.add(styleNames.SHOW_POPUP)},showPuzzleWord=t=>{t&&currentWord&&currentWord.split("").forEach(e=>{var r=document.createElement("span"),e=(r.innerHTML=e,keyMap.get(e)),e=Array.from(e.classList);e.includes(styleNames.INCORRECT_LOCATION_LETTER)?r.classList.add(styleNames.INCORRECT_LOCATION_LETTER):e.includes(styleNames.CORRECT_LOCATION)?r.classList.add(styleNames.CORRECT_LOCATION):r.classList.add(styleNames.NOTFOUND_LETTER),t.appendChild(r)})},resetGame=()=>{Array.from(document.querySelectorAll(".popup")).forEach(e=>{e.classList.remove(styleNames.SHOW_POPUP)}),Array.from(document.querySelectorAll(".letter")).forEach(e=>{e.innerHTML="",e.classList=["letter"]}),Array.from(keyMap.values()).forEach(e=>{var r=Array.from(e.classList).filter(e=>styleNames.DEFAULT_KEY_STYLES.includes(e));e.classList=r.join(" ")});var e=document.querySelector("#genericPopup");e&&(e.querySelector("#genericMessage").innerHTML=""),document.querySelector("#puzzleWord").innerHTML="",currentLineIndex=0,currentWord=getCurrentWord(),currentWordMetrics=setWordMetrics(currentWord),isGameOver=!1,genericPopupTimeout&&(clearInterval(genericPopupTimeout),genericPopupTimeout=null)},getLibrary=()=>["about","above","abuse","adult","after","again","agree","alarm","allow","alone","along","among","angry","apart","apple","apply","argue","asked","avoid","basis","beach","beads","begin","being","black","block","blood","board","books","boots","brand","brave","bread","break","bring","broke","brown","build","bulls","cabin","cares","carry","catch","cause","cells","chair","check","chest","chief","child","chips","claim","class","clean","clear","cliff","close","color","comes","couch","could","court","cover","cream","crime","crops","cross","crush","dance","death","doesn","doing","dozen","dream","dress","drink","drive","dryer","early","earns","eases","eaten","egges","eight","empty","ended","enjoy","enter","event","every","faith","favor","fears","field","fight","final","first","fixed","flies","floor","flour","focus","force","fresh","front","fruit","funny","glass","going","grass","great","green","group","guess","happy","haven","heard","heart","heavy","helps","hired","hotel","house","human","hurts","image","issue","items","japan","keeps","knows","large","later","latin","laugh","leads","learn","least","leave","legal","level","light","liked","likes","liter","lived","lives","local","looks","loved","lower","lunch","lying","magic","major","makes","maria","masks","match","maybe","media","might","miles","mitch","model","money","month","moved","movie","music","named","needs","never","nicer","niece","night","noisy","north","notes","occur","offer","often","older","order","other","paper","party","peace","phone","photo","piece","place","plane","plant","point","porch","pound","power","price","prove","puppy","quiet","quite","radio","raise","range","reach","ready","relax","reply","reuse","right","rocks","ropes","rough","ruins","rules","salad","sales","santa","scene","score","seats","sense","serve","seven","shake","share","shelf","shirt","shock","shoes","shoot","short","shows","since","skill","sleep","slice","small","smith","smoke","solid","solve","sorry","sound","south","space","speak","spend","sport","spray","spree","staff","stage","stand","start","state","stays","still","stock","stole","store","storm","story","stove","study","stuff","style","sugar","sunny","swift","table","taken","takes","talks","teach","teens","thank","their","theme","there","these","thing","think","third","those","three","threw","throw","tight","times","tired","today","toned","topic","touch","tough","track","trade","trail","train","trash","treat","trial","trick","tried","truck","trust","truth","twice","under","until","upset","value","video","virus","visit","voice","wants","watch","water","weeks","where","which","while","white","whole","whose","woman","woods","works","world","worry","worth","would","write","wrong","years","young","yours"],startGame=()=>{library=getLibrary(),currentWord=getCurrentWord(),currentWordMetrics=setWordMetrics(currentWord),addKeyEvents(),addInstructionEvents(),addPlayAgainEvents()};startGame();