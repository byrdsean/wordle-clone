const library=["event"],lines=document.querySelectorAll(".line");let currentLineIndex=0,currentWord,currentWordMetrics,showNotEnoughTimeout,isGameOver=!1;document.querySelectorAll(".key").forEach(e=>{e.addEventListener("click",e=>{keypress(e.target.value)})}),window.addEventListener("keydown",e=>{keypress(e.key)}),document.querySelector("#playAgainYes").addEventListener("click",e=>{resetGame()}),document.querySelector("#playAgainNo").addEventListener("click",e=>{document.querySelector("#playAgain").classList.remove("show")});const getCurrentWord=()=>{var e=Math.floor(Math.random()*library.length);return library[e].toUpperCase()},setWordMetrics=e=>{const n=new Map;return e&&e.split("").forEach((e,r)=>{var t=n.get(e)||[];n.set(e,[...t,r])}),n},keypress=e=>{var r,t,n;if(!(isGameOver||!e||lines.length<=currentLineIndex))return"ENTER"===e.toUpperCase()?validateValue():"BACKSPACE"===e.toUpperCase()?removeLetter():void(1!==e.length||(e=e.toUpperCase(),r="A".charCodeAt(0),t="Z".charCodeAt(0),(n=e.charCodeAt(0))<r)||t<n||addLetter(e))},getCurrentLineLetters=()=>Array.from(lines[currentLineIndex].querySelectorAll(".letter")),removeLetter=()=>{var e=getCurrentLineLetters().reverse().find(e=>0!==e.innerHTML?.length);e&&(e.innerHTML="")},addLetter=e=>{var r=getCurrentLineLetters().find(e=>0===e.innerHTML?.length);r&&(r.innerHTML=e)},validateValue=()=>{var e=getCurrentLineLetters();if(e.find(e=>0===e.innerHTML?.length))return showNotEnough();e.forEach((e,r)=>{var t=e.innerHTML,t=currentWordMetrics.get(t)||[];0===t.length?e.classList.add("not-found"):(t=t.find(e=>e===r),e.classList.add(void 0===t?"incorrect-location":"correct-location"))}),currentLineIndex++,checkIfEndGame()},showNotEnough=()=>{const e=document.querySelector("#notEnoughLetters");e&&e.classList.add("show"),showNotEnoughTimeout||clearInterval(showNotEnoughTimeout),showNotEnoughTimeout=setTimeout(()=>{e.classList.remove("show")},1e3)},checkIfEndGame=()=>{var e=lines[currentLineIndex-1];Array.from(e.querySelectorAll(".letter")).map(e=>e.innerHTML).join("")===currentWord.toUpperCase()?(document.querySelector("#wonPopup").classList.add("show"),isGameOver=!0):lines.length<=currentLineIndex&&((e=document.querySelector("#failurePopup"))&&(e.querySelector("#puzzleWord").innerHTML=currentWord,e.classList.add("show")),isGameOver=!0),isGameOver&&document.querySelector("#playAgain").classList.add("show")},resetGame=()=>{Array.from(document.querySelectorAll(".popup")).forEach(e=>{e.classList.remove("show")}),Array.from(document.querySelectorAll(".letter")).forEach(e=>{e.innerHTML="",e.classList=["letter"]}),currentLineIndex=0,currentWord=getCurrentWord(),setWordMetrics(currentWord),isGameOver=!1,showNotEnoughTimeout&&(clearInterval(showNotEnoughTimeout),showNotEnoughTimeout=null)},startGame=()=>{currentWord=getCurrentWord(),currentWordMetrics=setWordMetrics(currentWord)};startGame();